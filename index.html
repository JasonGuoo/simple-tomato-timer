<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Tomato Timer</title>

    <!-- Fonts -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Nunito:wght@400;600;700;800&display=swap" rel="stylesheet">

    <!-- Styles -->
    <link rel="stylesheet" href="style.css">

    <!-- PWA Support -->
    <meta name="theme-color" content="#ff6b6b">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <link rel="icon" type="image/svg+xml" href="icon.svg">
    <link rel="apple-touch-icon" href="icon.svg">
    <link rel="manifest" href="manifest.json">
</head>

<body>

    <!-- Background Elements -->
    <div class="bg-shape shape-1"></div>
    <div class="bg-shape shape-2"></div>

    <div class="app-container">
        <header>
            <h1>Tomato Timer</h1>
            <div class="subtitle">Stay focused, be productive</div>
            <button id="settingsBtn" class="settings-toggle" title="Settings">‚öôÔ∏è</button>
        </header>

        <div class="timer-wrapper">
            <!-- Speech Bubble -->
            <div id="speech-bubble" class="speech-bubble hidden">
                Ready to focus? Let's go! üöÄ
            </div>

            <!-- Progress Ring -->
            <svg class="timer-svg" viewBox="0 0 240 240">
                <defs>
                    <linearGradient id="timer-gradient" x1="0%" y1="0%" x2="100%" y2="0%">
                        <stop offset="0%" style="stop-color:#ff6b6b;stop-opacity:1" />
                        <stop offset="100%" style="stop-color:#ffe66d;stop-opacity:1" />
                    </linearGradient>
                </defs>
                <circle cx="120" cy="120" r="112.5" class="timer-circle-bg"></circle>
                <circle cx="120" cy="120" r="112.5" class="timer-circle-progress" stroke="url(#timer-gradient)">
                </circle>
            </svg>

            <!-- Animated Tomato Character -->
            <div id="tomato-character" class="tomato-character">
                <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512" class="character-svg">
                    <defs>
                        <linearGradient id="tomato-gradient" x1="0%" y1="0%" x2="100%" y2="100%">
                            <stop offset="0%" style="stop-color:#ff6b6b;stop-opacity:1" />
                            <stop offset="100%" style="stop-color:#ee5253;stop-opacity:1" />
                        </linearGradient>
                    </defs>
                    <!-- Body -->
                    <circle cx="256" cy="280" r="200" fill="url(#tomato-gradient)" />
                    <!-- Highlights -->
                    <ellipse cx="200" cy="200" rx="60" ry="40" fill="white" opacity="0.2"
                        transform="rotate(-45 200 200)" />
                    <!-- Leaf -->
                    <path
                        d="M256 80 C 256 80, 200 40, 180 100 C 170 130, 220 150, 256 140 C 292 150, 342 130, 332 100 C 312 40, 256 80, 256 80 Z"
                        fill="#4ecdc4" stroke="#2d3436" stroke-width="5" stroke-linejoin="round" />
                    <path d="M256 80 C 256 80, 256 40, 256 20" stroke="#4ecdc4" stroke-width="15"
                        stroke-linecap="round" />
                    <!-- Face Group -->
                    <g class="face">
                        <!-- Eyes -->
                        <g class="eyes">
                            <circle cx="180" cy="280" r="25" fill="#2d3436" class="eye left" />
                            <circle cx="332" cy="280" r="25" fill="#2d3436" class="eye right" />
                            <circle cx="190" cy="270" r="8" fill="white" class="pupil" />
                            <circle cx="342" cy="270" r="8" fill="white" class="pupil" />
                        </g>
                        <!-- Sleeping Eyes (Hidden by default) -->
                        <g class="eyes-sleeping" style="display: none;">
                            <path d="M155 280 Q 180 300 205 280" fill="none" stroke="#2d3436" stroke-width="8"
                                stroke-linecap="round" />
                            <path d="M307 280 Q 332 300 357 280" fill="none" stroke="#2d3436" stroke-width="8"
                                stroke-linecap="round" />
                            <text x="380" y="260" font-size="40" fill="#2d3436" class="zzz" style="opacity: 0;">z</text>
                        </g>
                        <!-- Mouth -->
                        <path d="M220 330 Q 256 360 292 330" fill="none" stroke="#2d3436" stroke-width="10"
                            stroke-linecap="round" class="mouth" />
                        <!-- Cheeks -->
                        <circle cx="150" cy="310" r="20" fill="#ff9f43" opacity="0.6" class="cheek" />
                        <circle cx="362" cy="310" r="20" fill="#ff9f43" opacity="0.6" class="cheek" />
                    </g>
                </svg>
            </div>
        </div>

        <div class="timer-content">
            <div class="time-display">25:00</div>
            <div class="timer-label">Focus Time</div>
        </div>

        <div class="controls">
            <button class="btn btn-primary" id="startBtn">
                <span class="btn-icon">‚ñ∂Ô∏è</span> Start
            </button>
            <button class="btn" id="resetBtn">
                <span class="btn-icon">üîÑ</span> Reset
            </button>
        </div>

        <div class="loop-control">
            <label class="loop-switch">
                <input type="checkbox" id="loopToggle">
                <span class="loop-slider"></span>
                <span class="loop-label">Loop Mode (until 19:00)</span>
            </label>
        </div>

        <div class="presets">
            <button class="preset-btn active" data-mode="focus">Focus</button>
            <button class="preset-btn" data-mode="short">Short Break</button>
            <button class="preset-btn" data-mode="long">Long Break</button>
        </div>
    </div>

    <!-- Settings Modal -->
    <div id="settingsModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h2>Timer Settings</h2>
                <button id="closeSettings" class="close-btn">&times;</button>
            </div>
            <div class="modal-body">
                <div class="setting-group">
                    <label>Focus Time (min)</label>
                    <input type="number" id="focusTime" min="1" max="60" value="25">
                </div>
                <div class="setting-group">
                    <label>Short Break (min)</label>
                    <input type="number" id="shortBreak" min="1" max="30" value="5">
                </div>
                <div class="setting-group">
                    <label>Long Break (min)</label>
                    <input type="number" id="longBreak" min="1" max="60" value="15">
                </div>
            </div>
            <div class="modal-footer">
                <button id="saveSettings" class="btn btn-primary full-width">Save Settings</button>
            </div>
        </div>
    </div>

    <script src="script.js"></script>
    <script>
        // Register service worker if available
        if ('serviceWorker' in navigator) {
            window.addEventListener('load', () => {
                navigator.serviceWorker.register('./sw.js').catch(err => console.log('SW failed', err));
            });
        }
    </script>
</body>

</html>